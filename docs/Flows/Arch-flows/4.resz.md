# KGC ERP - 4. Rész: Szerviz

## Áttekintés

Ez a dokumentum a KGC ERP szerviz moduljának folyamatait írja le a videó transcript alapján. A szerviz modul kezeli a gépek javítását, munkalapok kezelését, árajánlatok készítését és a nagy céges számlázás speciális eseteit.

---

## Fő Folyamatok

### 1. Gép Felvétel Szervizbe

**Kiváltó esemény:** Ügyfél behozza a gépét javításra

**Lépések:**
1. Ügyfél érkezik a géppel
2. Gép adatainak felvétele:
   - Ügyfél nyilvántartási szám (pl. GD055)
   - Géptípus
   - Hibajelenség leírása
3. Rögzítés → Munkalap generálás
4. Munkalap szám kiosztása
5. Vonalkód matrica nyomtatás (gépre ragasztva)
6. Gép átadása szerviznek

**Munkalap adatok:**
- Munkalap szám (egyedi azonosító)
- Gép azonosító
- Felvétel dátuma
- Felvevő személy
- Probléma leírás

---

### 2. Szerviz Munka Folyamata

**Lépések:**
1. Szerelők látják a munkalapokat
2. Diagnosztika elvégzése
3. Szükséges alkatrészek meghatározása
4. Cikkszámok ráírása a munkalapra
5. Javítás elvégzése
6. Státusz beállítása

**Munkalap státuszok:**
| Státusz | Leírás |
|---------|--------|
| Felvéve | Gép beérkezett |
| Árajánlat | Drága javítás, ügyfél jóváhagyása szükséges |
| Javítás alatt | Munka folyamatban |
| Elkészült | Javítás befejezve |
| Számlázható | Csak ebben a státuszban számlázható! |

**Fontos:** Számlázás CSAK akkor lehetséges, ha a munkalap "Számlázható" pozícióban áll!

---

### 3. Árajánlat Készítés

**Kiváltó esemény:** Drága javítás várható, ügyfél jóváhagyása szükséges

**Lépések:**
1. Szerelő beállítja: "Árajánlat" státusz
2. Alkatrészek és munkadíj meghatározása
3. Árajánlat dokumentum készítése
4. Ügyfél értesítése
5. Döntés:
   - **Elfogadva** → Javítás folytatása
   - **Elutasítva** → Gép visszaadása javítás nélkül

---

### 4. Egyszerű Ügyfél Számlázás (Normál Eset)

**Kiváltó esemény:** Magánszemély vagy kis cég javítása kész

**Lépések:**
1. Ügyfél megérkezik munkalappal
2. Munkalap vonalkód beolvasása
3. Tételek ellenőrzése (alkatrészek + munkadíj)
4. Számla kiállítása
5. Fizetés (készpénz/kártya/átutalás)
6. Gép átadása

**Megjegyzés:** Ez a folyamat egyszerű és gyors.

---

### 5. Nagy Céges Számlázás (Speciális Eset)

**Kiváltó esemény:** Szerződéses partner (pl. FGS, Gödöllő) gépe elkészült

**Probléma:**
- Nagy cégeknek saját cikkszámaik vannak
- Normál számlát nem fogadnak el
- Minden szerződés más óradíjjal működik

**Megoldás - "Nullás Kifuttatás":**

1. **Belső ügyfélkód használata:**
   - Minden területnek saját ügyfélkód (nem hivatalos, nincs adószám)
   - Követhetőség: melyik telephely, melyik gép

2. **Kedvezményes rögzítés nullázással:**
   - Tételek rögzítése
   - Minden tétel lenullázása (0 Ft)
   - Munkalap lezárása
   - Gép kiadható

3. **Árajánlat készítése:**
   - Fiúk munkalapja alapján
   - Vevő adatok kitöltése
   - Hivatkozási szám (nagy cég nyilvántartása)
   - Cikkszámok + árak (szerződés szerinti óradíj)
   - Árajánlat küldése nagy cégnek

4. **Hivatalos dokumentáció:**
   - Nagy cég visszaküld: Megrendelő, Teljesítésigazolás
   - Ezek alapján készül a hivatalos számla

5. **Végső számla:**
   - Egy összeg szerepel
   - Nagy cég belső cikkszámával
   - Melléklet: árajánlat + teljesítésigazolás

**Miért kell nullásan kifuttatni?**
- A tételeket NEM a készletről veszik le
- Csak a követhetőség miatt rögzítik
- A valós elszámolás a nagy cég rendszerében történik

---

## Entitások

### Munkalap
| Mező | Típus | Leírás |
|------|-------|--------|
| munkalap_szam | VARCHAR | Egyedi azonosító |
| ugyfél_id | INT | FK → Partner |
| gep_azonosito | VARCHAR | Ügyfél gépszáma |
| geptipus | VARCHAR | Gép típusa |
| felvetel_datum | DATE | Beérkezés dátuma |
| felvevo_id | INT | FK → Felhasználó |
| problema_leiras | TEXT | Hibajelenség |
| statusz | ENUM | felvéve/árajánlat/javítás/elkészült/számlázható |
| vonalkod | VARCHAR | Munkalap vonalkód |

### Munkalap_Tetel
| Mező | Típus | Leírás |
|------|-------|--------|
| munkalap_id | INT | FK → Munkalap |
| cikkszam | VARCHAR | FK → Cikk |
| mennyiseg | INT | Felhasznált darab |
| egysegar | DECIMAL | Ár (lehet 0 nullázásnál) |
| megjegyzes | VARCHAR | Szerelő megjegyzés |

### Arajanalt
| Mező | Típus | Leírás |
|------|-------|--------|
| arajanalt_szam | VARCHAR | Egyedi azonosító |
| munkalap_id | INT | FK → Munkalap |
| vevo_id | INT | FK → Partner |
| hivatkozasi_szam | VARCHAR | Nagy cég belső száma |
| osszeg | DECIMAL | Teljes összeg |
| statusz | ENUM | küldött/elfogadott/elutasított |
| oradij | DECIMAL | Szerződés szerinti óradíj |

### Belso_Ugyfél (Nagy Céges Követés)
| Mező | Típus | Leírás |
|------|-------|--------|
| kod | VARCHAR | Belső azonosító |
| telephely | VARCHAR | Terület/telephely neve |
| fo_partner_id | INT | FK → Partner (fő cég) |
| megjegyzes | VARCHAR | Leírás |

---

## Döntési Pontok

1. **Milyen típusú ügyfél?**
   - Magánszemély/kis cég → Normál számlázás
   - Nagy céges szerződés → Nullás kifuttatás

2. **Szükséges árajánlat?**
   - Drága javítás → Árajánlat státusz
   - Normál javítás → Közvetlen javítás

3. **Árajánlat elfogadva?**
   - Igen → Javítás folytatása
   - Nem → Gép visszaadása

4. **Munkalap státusza megfelelő?**
   - "Számlázható" → Számla kiállítható
   - Más státusz → NEM számlázható!

---

## Speciális Esetek

### Nagy Céges Óradíj Kezelés
- Minden szerződés más óradíjjal
- Szerelőknek nem kell fejben tartani
- Az árajánlaton a megfelelő óradíj szerepel
- Központilag kezelt szerződési feltételek

### Vonalkód Használat
- Munkalapok vonalkóddal azonosíthatók
- Gyors előhívás bármelyik géphez
- Gépre ragasztott matrica

### Követhetőség
- Ki vette fel a gépet
- Ki írta be a problémát
- Ki végezte a javítást
- Mikor vitték el a gépet

---

## Problémák és Megoldások

| Probléma | Megoldás |
|----------|----------|
| Nagy cég nem fogad el normál számlát | Nullás kifuttatás + árajánlat |
| Szerződésenként eltérő óradíj | Központi árajánlat készítés |
| Készlet nem csökkenthető nagy cégnél | Tételek nullázása |
| Telephely azonosítás | Belső ügyfélkódok |

---

## Kapcsolódó Diagramok

- [4-szerviz-folyamat.excalidraw](diagrams/4-szerviz-folyamat.excalidraw) - Szerviz fő folyamat
- [4-szerviz-munkalap.excalidraw](diagrams/4-szerviz-munkalap.excalidraw) - Munkalap életciklus
- [4-szerviz-erd.excalidraw](diagrams/4-szerviz-erd.excalidraw) - Entitás kapcsolatok

---

## Transcript Részlet

> "Behoznak mondjuk Gödöllőről egy gépet. FGS-sel szerződésben vagyunk, akkor én megkapom az adatokat a gépről és felveszem..."

> "Itt az a probléma, hogy például akikkel nagy szerződésben vagyunk, nekik ilyen számlát nem lehet leadni, mert mindenre saját kódjuk van..."

> "Azért kell nullásan kifuttatni, mert ezeket a tételeket nem veszik le készletről."

---

*Dokumentum verzió: 1.0*
*Készült: KGC ERP Workflow Dokumentáció*

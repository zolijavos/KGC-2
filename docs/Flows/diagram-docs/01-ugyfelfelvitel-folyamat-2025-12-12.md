# 1. √úgyf√©l Felv√©tel Folyamat v3.0

## Diagram Alapinform√°ci√≥k

| Tulajdons√°g | √ârt√©k |
|-------------|-------|
| **F√°jln√©v** | `01-ugyfelfelvitel-folyamat-2025-12-12.excalidraw` |
| **T√≠pus** | Flowchart (Folyamat√°bra) |
| **Modul** | B√©rl√©s / √úgyf√©lkezel√©s |
| **Verzi√≥** | v3.0 |
| **D√°tum** | 2025-12-12 |
| **St√°tusz** | M√ìDOS√çTOTT |
| **Forr√°s** | fit-gap-analysis-2025-12-12.md |

---

## R√©szletes Le√≠r√°s

Ez a folyamat√°bra a **b√©rl√©s ind√≠t√°si folyamatot** mutatja be az √∫j **R.1/R.2 Kiad√°si Javaslat** integr√°ci√≥val. A kezel≈ë kap egy t√°rhely javaslatot a rendszert≈ël, amit elfogadhat vagy fel√ºlb√≠r√°lhat indokl√°ssal.

---

## Folyamat L√©p√©sei

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    B√âRL√âS IND√çT√ÅS                           ‚îÇ
‚îÇ                  (R.1/R.2 Integr√°ci√≥)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  Kezd√©s  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Partner/√úgyf√©l       ‚îÇ
    ‚îÇ azonos√≠t√°s           ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ B√©rl√©s ind√≠t√°sa      ‚îÇ
    ‚îÇ (id≈ëtartam v√°laszt√°s)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ B√©rg√©p kiv√°laszt√°sa  ‚îÇ
    ‚îÇ (cikksz√°m/vonalk√≥d)  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ üÜï R.1 Kiad√°si Javaslat                  ‚îÇ
    ‚îÇ                                          ‚îÇ
    ‚îÇ K√âSZLET_HELY lek√©rdez√©s                  ‚îÇ
    ‚îÇ priorit√°s szerint rendezve               ‚îÇ
    ‚îÇ ‚Üí T√°rhely javaslat lista                 ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  R.2 Kezel≈ë          ‚îÇ
    ‚îÇ  elfogadja?          ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îÇ
         ‚îÇ      ‚îÇ                            ‚îÇ
     IGEN‚îÇ      ‚îÇNEM                         ‚îÇ
         ‚îÇ      ‚îÇ                            ‚îÇ
         ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
         ‚îÇ ‚îÇ Fel√ºlb√≠r√°l√°s:                ‚îÇ  ‚îÇ
         ‚îÇ ‚îÇ ‚Ä¢ M√°sik t√°rhely v√°laszt√°s    ‚îÇ  ‚îÇ
         ‚îÇ ‚îÇ ‚Ä¢ Indokl√°s K√ñTELEZ≈ê          ‚îÇ  ‚îÇ
         ‚îÇ ‚îÇ ‚Ä¢ KIADASI_AUDIT log          ‚îÇ‚îÄ‚îÄ‚îò
         ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Kauci√≥ r√∂gz√≠t√©se     ‚îÇ
    ‚îÇ (k√©szp√©nz/k√°rtya)    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ K√âSZLET_HELY         ‚îÇ
    ‚îÇ friss√≠t√©s            ‚îÇ
    ‚îÇ + K√âSZLET_MOZG√ÅS log ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   V√©ge   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## R.1 Kiad√°si Javaslat Algoritmus

```sql
-- R.1 Algoritmus: T√°rhely javaslatok priorit√°s szerint
SELECT
    tarhely_kod,
    mennyiseg,
    kiadasi_prioritas
FROM KESZLET_HELY
WHERE cikk_id = @cikk_id
  AND aktiv = TRUE
  AND mennyiseg > 0
ORDER BY kiadasi_prioritas ASC;

-- Eredm√©ny: Legkisebb priorit√°s = legels≈ë javaslat
```

### Priorit√°s √ârtelmez√©se

| Priorit√°s | Hely t√≠pus | El√©rhet≈ës√©g |
|-----------|------------|-------------|
| 1 | Pult | Leggyorsabb |
| 2 | Elad√≥t√©r | Gyors |
| 3 | Rakt√°r eleje | K√∂zepes |
| 4 | Rakt√°r h√°tulja | Lassabb |
| 5 | T√°voli | Leglassabb |

---

## R.2 Fel√ºlb√≠r√°l√°s Kezel√©se

### K√∂telez≈ë Indokl√°sok

| K√≥d | Jelent√©s | Le√≠r√°s |
|-----|----------|--------|
| `SERULT` | S√©r√ºlt term√©k | A javasolt helyr≈ël s√©r√ºlt term√©ket tal√°ltak |
| `LELTARELTERES` | Lelt√°relt√©r√©s | A rendszer szerinti k√©szlet nem egyezik |
| `UGYFEL_KERES` | √úgyf√©l k√©r√©s | Az √ºgyf√©l specifikus term√©ket k√©r |
| `HOZZAFERHETO` | K√∂nnyebb hozz√°f√©r√©s | A fel√ºl√≠rt hely k√∂nnyebben el√©rhet≈ë |
| `EGYEB` | Egy√©b | Szabad sz√∂veges indokl√°s |

### KIADASI_AUDIT Bejegyz√©s

```sql
INSERT INTO KIADASI_AUDIT (
    tenant_id,
    cikk_id,
    javasolt_tarhely,
    valasztott_tarhely,
    indoklas_kod,
    indoklas_szoveg,
    felhasznalo_id,
    datum
) VALUES (
    @tenant_id,
    @cikk_id,
    @r1_javaslat,      -- R.1 √°ltal javasolt
    @kezel≈ë_valasztas, -- Kezel≈ë v√°laszt√°sa
    @indoklas_kod,     -- SERULT/EGYEB/stb.
    @szabad_szoveg,    -- Ha EGYEB
    @felhasznalo_id,
    NOW()
);
```

---

## K√©szletv√°ltoz√°s R√∂gz√≠t√©se

### K√âSZLET_HELY Friss√≠t√©s

```sql
-- Kiad√°sn√°l cs√∂kkent√©s
UPDATE KESZLET_HELY
SET mennyiseg = mennyiseg - @kiadott_db,
    utolso_frissites = NOW()
WHERE cikk_id = @cikk_id
  AND tarhely_kod = @valasztott_tarhely;
```

### K√âSZLET_MOZG√ÅS Log

```sql
INSERT INTO KESZLET_MOZGAS (
    tenant_id,
    cikk_id,
    tipus,           -- '-' (kiad√°s)
    mennyiseg,
    tarhely_kod,     -- üÜï melyik t√°rhelyr≈ël
    megjegyzes,
    datum,
    rogzito_id
) VALUES (
    @tenant_id,
    @cikk_id,
    '-',
    @kiadott_db,
    @valasztott_tarhely,
    'B√©rl√©s kiad√°s',
    NOW(),
    @felhasznalo_id
);
```

---

## V√°ltoz√°sok √ñsszefoglal√≥ja

| L√©p√©s | Kor√°bbi | √öj (v3.0) |
|-------|---------|-----------|
| T√°rhely v√°laszt√°s | Manu√°lis | R.1 automatikus javaslat |
| Fel√ºlb√≠r√°l√°s | Nincs napl√≥z√°s | KIADASI_AUDIT + indokl√°s |
| K√©szlet friss√≠t√©s | CIKK.keszlet | K√âSZLET_HELY.mennyiseg |
| Mozg√°s napl√≥z√°s | Nincs t√°rhely | + tarhely_kod mez≈ë |

---

## Kapcsol√≥d√≥ Dokumentumok

- [02-keszlet-multi-location-erd-2025-12-12.md](02-keszlet-multi-location-erd-2025-12-12.md) - K√âSZLET_HELY entit√°s
- [02-kiadasi-optimalizacio-folyamat-2025-12-12.md](02-kiadasi-optimalizacio-folyamat-2025-12-12.md) - R.1/R.2 algoritmus r√©szletei
- [fit-gap-analysis-2025-12-12.md](../fit-gap-analysis-2025-12-12.md) - K√∂vetelm√©ny forr√°s
